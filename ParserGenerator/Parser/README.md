# Parsing Module README

## Overview

The parsing module is a crucial component of the compiler that facilitates the transformation of a sequence of tokens, generated by the lexical analyzer, into a parse tree. This module is responsible for enforcing the syntactic rules of the programming language through the use of a parsing table and a stack-based parsing algorithm.

## Classes

### 1. **Parser (Parser.h)**
```cpp
class Parser {
unordered_map<const Definition*, unordered_map<string, vector<const Definition*>>> table;
public:
    Parser(const unordered_map<const Definition*, unordered_map<string, vector<const Definition*>>>& parsingTable);
    std::shared_ptr<const ParseTreeNode> parse(LexicalAnalyzer& lexicalAnalyzer, const Definition* startSymbol);
};
```

### 2. **ParseTreeNode (TreeNode.h)**
```cpp
class ParseTreeNode {
public:
    const Definition* content;
    vector<std::shared_ptr< const ParseTreeNode>> children;

    bool getIsTerminal();
    explicit ParseTreeNode(const Definition* definition);
    void insertLeft(std::shared_ptr<const ParseTreeNode> child);
    void insertRight(std::shared_ptr<const ParseTreeNode> child);
    void plotGraph(const std::string& outputPath) const;
    void printLeftmostDerivationSteps(std::ostream& os, vector<const Definition*> ignoreList) const;
};
```

## Parsing Algorithm

The parsing algorithm used by the `Parser` class is a stack-based approach that employs a predictive parsing table for decision making. Here is a simplified pseudocode representation:
```cpp
initialize empty parse tree T
initialize root node S with start symbol
insert S into T
initialize stack with S
initialize currentToken
while stack is not empty:
    stackTopNode = top of stack
    if stackTopNode matches currentToken:
        matchToken()
    else if stackTopNode is a terminal:
        Perform Error Recovery
    else:
        row = stackTopNode.content
        column = currentToken.type or eofString
        if table[row][column] exists:
            production = table[row][column]
            insert production into T
            for element in reverse(production):
                push element into stack
        else:
            Perform Error Recovery
            
if excess tokens or unexpected EOF:
    handleExcessTokensOrEOFError()
```

## Error Recovery

The parsing module includes error handling mechanisms to recover from unexpected situations. These mechanisms involve discarding or inserting tokens, as well as sync and error productions.
1. Inserting an input token:

    If the current token does not match the top of the stack, and the stack top is a terminal, an error occurs. In this case, the stack top is inserted onto the input, the token is matched, and parsing continues.


2. Discarding an input token:
     
    If there is no valid production for the current non-terminal and token, an error is detected. In this case, the current token is discarded from the input, and parsing continues.


3. Parsing Table Sync Cell:

    If the production for the current non-terminal and token is empty, a sync rule is applied. The stack top (non-terminal) is popped, and parsing continues.

## Usage Example
Check `ParserUsageExample.cpp`